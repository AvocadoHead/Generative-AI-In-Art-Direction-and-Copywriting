const translations = {
  en: {
    brand: 'Crack the Brief | Multimodal Workshop',
    'hero.label': 'What Now',
    'hero.title': 'Everything happens at once.',
    'hero.subtitle':
      'Cracking the brief in the multimodal space. A deep-dive workshop in strategy, creative, and visual development in the age of Generative AI.',

    'shift.label': 'Paradigme',
    'shift.title': 'The shift: from “copy here, visual there” to one unified canvas.',
    'shift.body1':
      'Most of the industry still works in a “divide and fragment” mindset. Copy in one tab, images in another, and the original brief gets lost somewhere in the middle. The result: friction. Too many technical handoffs, not enough continuous creation.',
    'shift.body2':
      'This workshop moves you into a unified workflow. Forget ping-ponging between tools. We work on a single generative canvas, where written strategy and visual output evolve side by side.',

    'method.label': 'Recipe',
    'method.title': 'The methodology: from brief to video in 4 movements.',
    'method.intro':
      'A structured workflow that turns creative chaos into a precise pipeline.',
    'method.step1.label': 'Movement I',
    'method.step1.title': 'Decode the brief into story-DNA',
    'method.step1.body':
      'We begin by unpacking the brief into tone, tensions, emotional arc, and core images – before any prompt is written. The goal is to agree on what the piece really wants to say.',
    'method.step2.label': 'Movement II',
    'method.step2.title': 'Build the multimodal sketchbook',
    'method.step2.body':
      'From that story-DNA we generate visual and textual sketches: multiple prompt directions, camera and composition ideas, rhythm and typography. Everything lives on one canvas instead of scattered files.',
    'method.step3.label': 'Movement III',
    'method.step3.title': 'Refine into look & feel',
    'method.step3.body':
      'We sift through the experiments, keep what sings, and shape a clear look & feel: color, texture, motion language. The result is a visual direction everyone can recognize and work with.',
    'method.step4.label': 'Movement IV',
    'method.step4.title': 'Compose the final piece',
    'method.step4.body':
      'Finally we assemble the assets into a coherent flow: sequence of scenes, timing, typographic moments, sound and export strategy – from first frame to last.',

    'value.label': 'Outcome',
    'value.title': 'What you leave with',
    'value.intro':
      'The workshop is designed so you don’t just understand the method in theory – you walk out with something concrete.',
    'value.card1.title': 'A practical multimodal workflow',
    'value.card1.body':
      'A repeatable process you can reuse with different tools and briefs, without starting from zero every time a new platform appears.',
    'value.card2.title': 'A live project in progress',
    'value.card2.body':
      'A real piece – concept, board, or near-final video – built on top of your own material or an industry-style brief.',
    'value.card3.title': 'A shared language for the team',
    'value.card3.body':
      'A vocabulary that connects strategy, copy, design and motion, so the process becomes more fluid and less fragmented.',

    'bio.label': 'About me',
    'bio.title': 'Eyal Izenman',
    'bio.body':
      'Creator, animator, motion designer, and thought leader in the Generative AI space. With decades of weaving music, design and movement, Eyal Izenman works where human intuition meets algorithmic improvisation.',
    'bio.quote':
      '“AI is not a tech trick – it is a full creative space. My goal is to help you surface the idea, refine it, and turn it into a complete visual asset – in one continuous breath.”',

    'cta.line':
      'The full pipeline: Brief ← Story DNA ← Language & style ← Mutation ← Refinement ← Moodboard ← Look & Feel ← Storyboard ← Video.',
    'cta.button': 'Talk to me about the workshop'
  },
  he: {
    brand: 'לפצח את הבריף | סדנה לעבודה מולטימודלית',
    'hero.label': 'מה עכשיו',
    'hero.title': 'הכל קורה בבת אחת.',
    'hero.subtitle':
      'סדנה מעמיקה בפיצוח בריפים במרחב המולטימודלי – אסטרטגיה, קריאייטיב ופיתוח חזותי בעידן ה-AI הגנרטיבי.',

    'shift.label': 'פרדיגמה',
    'shift.title': 'המעבר: מטקסט פה וויז׳ואל שם – לקנבס אחד מאוחד.',
    'shift.body1':
      'רוב התעשייה עדיין עובדת בפיצול: טקסט בחלון אחד, תמונות באחר, והבריף המקורי הולך לאיבוד באמצע. התוצאה: חיכוך אינסופי, יותר מדי העברות, מעט מדי יצירה רציפה.',
    'shift.body2':
      'בסדנה אנחנו עוברים לקנבס גנרטיבי אחד, שבו שפה, רעיון ותמונה מתפתחים יחד – במקום להתרוצץ בין כלים וחלונות שונים.',

    'method.label': 'מתכון',
    'method.title': 'המתודולוגיה: מבריף לווידאו בארבעה מהלכים.',
    'method.intro':
      'תהליך מובנה שמארגן את הכאוס היצירתי לצינור עבודה ברור.',
    'method.step1.label': 'מהלך I',
    'method.step1.title': 'פירוק הבריף ל-DNA של סיפור',
    'method.step1.body':
      'מתחילים בתרגום הבריף לעמוד שדרה סיפורי: טון, מתחים, קשת רגשית ותמונות מרכזיות – עוד לפני שנכתבת מילה אחת של פרומפט.',
    'method.step2.label': 'מהלך II',
    'method.step2.title': 'מחברת הסקיצות המולטימודלית',
    'method.step2.body':
      'מה-DNA הסיפורי אנחנו מייצרים סקיצות – וריאציות של פרומפטים, בחירות מצלמה וקומפוזיציה, קצב וטיפוגרפיה – כולן חיות על אותו קנבס.',
    'method.step3.label': 'מהלך III',
    'method.step3.title': 'ממוּדבורד ללוק & פיל',
    'method.step3.body':
      'מצמצמים את הרעש לאסתטיקה ממוקדת: צבע, טקסטורות, חתימת תנועה. המטרה: לוק & פיל שכולם יכולים לזהות כ״זה שלנו״.',
    'method.step4.label': 'מהלך IV',
    'method.step4.title': 'הלחנת היצירה הסופית',
    'method.step4.body':
      'מסדרים הכול בזמן: סדר סצנות, קצב, רגעים טיפוגרפיים, סאונד ואסטרטגיית אקספורט – מפריים ראשון ועד אחרון.',

    'value.label': 'תוצאה',
    'value.title': 'עם מה אתם יוצאים מהסדנה',
    'value.intro':
      'המטרה היא שלא תצאו רק עם השראה – אלא עם מתודה ועם התחלה של יצירה משלכם.',
    'value.card1.title': 'מתודה מולטימודלית מעשית',
    'value.card1.body':
      'תהליך עבודה שניתן לשחזר על בריפים שונים וכלים משתנים, בלי להתחיל מאפס בכל פעם שיוצאת פלטפורמה חדשה.',
    'value.card2.title': 'פרויקט חי בתהליך',
    'value.card2.body':
      'קונספט, סקיצה או וידאו כמעט סופי – שנבנים על בסיס חומר שלכם או בריף משותף שעובדים עליו בסדנה.',
    'value.card3.title': 'שפה משותפת לצוות',
    'value.card3.body':
      'שפה שמחברת בין אסטרטגיה, קופי, עיצוב ותנועה – כך שהתהליך הופך זורם יותר ופחות מפוצל.',

    'bio.label': 'עליי',
    'bio.title': 'איל איזנמן',
    'bio.body':
      'יוצר, מנפיש ומעצב תנועה, מהקולות הבולטים בישראל בשדה ה-AI היצירתי. שוזר יחד מוזיקה, עיצוב ותנועה למרחבים גנרטיביים.',
    'bio.quote':
      '״AI הוא לא טריק טכנולוגי – הוא מרחב יצירתי שלם. המטרה שלי היא לעזור לך לזקק את הרעיון ולהפוך אותו לנכס חזותי שלם, בנשימה אחת רציפה.״',

    'cta.line':
      'הצינור המלא: בריף ← DNA של סיפור ← שפה וסגנון ← מוטציות ← ליטוש ← מוּדבורד ← לוק & פיל ← סטוריבורד ← וידאו.',
    'cta.button': 'דברו איתי על הסדנה'
  }
};

function applyTranslations(lang) {
  const dict = translations[lang] || translations.he;
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.getAttribute('data-i18n');
    if (dict[key]) el.textContent = dict[key];
  });
}

// WORD CLOUD STATE
let canvas, ctx;
const words = [
  'ferment', 'distill', 'dream', 'style', 'composition', 'palette',
  'story', 'motive', 'theme', 'color', 'emotion', 'texture',
  'draft', 'mutation', 'refinement', 'prompt', 'camera', 'lens',
  'sound', 'motion', 'layout', 'cut', 'transition', 'timing',
  'vision', 'aesthetic', 'craft', 'form', 'content', 'meaning',
  'intention', 'expression', 'detail', 'gesture', 'spirit'
];

let particles = [];
let rotationX = 0;
let rotationY = 0;
let momentumX = 0;
let momentumY = 0;
let isDragging = false;
let lastMouseX = 0;
let lastMouseY = 0;

function initWordCloud() {
  canvas = document.getElementById('wordCloud');
  if (!canvas) return;
  ctx = canvas.getContext('2d');

  resizeCanvas();
  window.addEventListener('resize', resizeCanvas);

  // create particles on a sphere
  particles = [];
  const radius = 180;
  words.forEach(word => {
    const theta = Math.random() * Math.PI * 2;
    const phi = Math.acos(Math.random() * 2 - 1);
    particles.push({
      word,
      x: radius * Math.sin(phi) * Math.cos(theta),
      y: radius * Math.sin(phi) * Math.sin(theta),
      z: radius * Math.cos(phi)
    });
  });

  // mouse events
  canvas.addEventListener('mousedown', e => {
    isDragging = true;
    lastMouseX = e.clientX;
    lastMouseY = e.clientY;
    canvas.style.cursor = 'grabbing';
  });

  canvas.addEventListener('mousemove', e => {
    if (!isDragging) return;
    const deltaX = e.clientX - lastMouseX;
    const deltaY = e.clientY - lastMouseY;
    lastMouseX = e.clientX;
    lastMouseY = e.clientY;
    rotationY += deltaX * 0.005;
    rotationX += deltaY * 0.005;
    momentumY = deltaX * 0.0005;
    momentumX = deltaY * 0.0005;
  });

  canvas.addEventListener('mouseup', () => {
    isDragging = false;
    canvas.style.cursor = 'grab';
  });

  canvas.addEventListener('mouseleave', () => {
    isDragging = false;
    canvas.style.cursor = 'grab';
  });

  // touch events
  canvas.addEventListener('touchstart', e => {
    isDragging = true;
    const touch = e.touches[0];
    lastMouseX = touch.clientX;
    lastMouseY = touch.clientY;
  }, { passive: true });

  canvas.addEventListener('touchmove', e => {
    if (!isDragging) return;
    const touch = e.touches[0];
    const deltaX = touch.clientX - lastMouseX;
    const deltaY = touch.clientY - lastMouseY;
    lastMouseX = touch.clientX;
    lastMouseY = touch.clientY;
    rotationY += deltaX * 0.005;
    rotationX += deltaY * 0.005;
    momentumY = deltaX * 0.0005;
    momentumX = deltaY * 0.0005;
  }, { passive: true });

  canvas.addEventListener('touchend', () => {
    isDragging = false;
  }, { passive: true });

  canvas.style.cursor = 'grab';
  requestAnimationFrame(animateWordCloud);
}

function resizeCanvas() {
  if (!canvas) return;
  const dpr = window.devicePixelRatio || 1;
  const rect = canvas.getBoundingClientRect();
  canvas.width = rect.width * dpr;
  canvas.height = rect.height * dpr;
  ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
}

function rotatePoint(x, y, z) {
  const cosY = Math.cos(rotationY);
  const sinY = Math.sin(rotationY);
  const tempX = x * cosY - z * sinY;
  const tempZ = z * cosY + x * sinY;

  const cosX = Math.cos(rotationX);
  const sinX = Math.sin(rotationX);
  const tempY = y * cosX - tempZ * sinX;
  const finalZ = tempZ * cosX + y * sinX;

  return { x: tempX, y: tempY, z: finalZ };
}

function animateWordCloud() {
  if (!canvas || !ctx) return;
  requestAnimationFrame(animateWordCloud);

  const rect = canvas.getBoundingClientRect();
  const width = rect.width;
  const height = rect.height;

  ctx.clearRect(0, 0, width, height);

  if (!isDragging) {
    rotationY += momentumY;
    rotationX += momentumX;
    momentumX *= 0.95;
    momentumY *= 0.95;
    rotationY += 0.001;   // slow auto-rotate
    rotationX += 0.0005;
  }

  const sorted = particles
    .map(p => {
      const rotated = rotatePoint(p.x, p.y, p.z);
      return { ...p, ...rotated };
    })
    .sort((a, b) => a.z - b.z);

  sorted.forEach(p => {
    const scale = 600 / (600 + p.z);
    const screenX = width / 2 + p.x * scale;
    const screenY = height / 2 + p.y * scale;
    const fontSize = 14 + scale * 8;
    const opacity = 0.3 + scale * 0.7;

    ctx.save();
    ctx.globalAlpha = opacity;
    ctx.font = `${fontSize}px Heebo, sans-serif`;
    ctx.fillStyle = '#5a3418'; // warm brown text
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(p.word, screenX, screenY);
    ctx.restore();
  });
}

document.addEventListener('DOMContentLoaded', () => {
  // start in Hebrew, RTL
  document.documentElement.lang = 'he';
  document.documentElement.dir = 'rtl';
  applyTranslations('he');

  // language toggle
  document.querySelectorAll('.lang-toggle button').forEach(btn => {
    btn.addEventListener('click', () => {
      document
        .querySelectorAll('.lang-toggle button')
        .forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      const lang = btn.dataset.lang;
      applyTranslations(lang);

      if (lang === 'he') {
        document.documentElement.lang = 'he';
        document.documentElement.dir = 'rtl';
      } else {
        document.documentElement.lang = 'en';
        document.documentElement.dir = 'ltr';
      }
    });
  });

  // scroll-in animations
  const observer = new IntersectionObserver(
    entries => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
          observer.unobserve(entry.target);
        }
      });
    },
    { threshold: 0.1 }
  );

  document.querySelectorAll('.anim').forEach(el => observer.observe(el));

  // init word cloud
  initWordCloud();
});
